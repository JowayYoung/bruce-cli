#!/usr/bin/env node
const e=require("chalk"),i=require("fs"),r=require("util"),o=require("commander"),s=require("dayjs"),a=require("latest-version"),n=require("rimraf"),t=require("semver"),{version:c}=require("../package"),{ACTION_TEXT:l,GLOB_TEXT:u}=require("../i18n"),{AbsPath:d,AutoBin:m,IsExist:p,ShowMsg:g}=require("../util/setting");(async()=>{if(t.lt(process.version,"v12.0.0")&&(g("red",u.judgeVerNode),process.exit(1)),t.eq(c,await a("bruce-cli"))||g("red",u.judgeVerBruce),p("../process.lock",1)){const e=r.promisify(n),o=d("..",1),a=d("../process.lock",1);s().format("YYYY-MM-DD HH:mm:ss")>=i.readFileSync(a,"utf8")&&(await e(o),process.exit(1))}o.usage(e.yellowBright("<command> [option]")).version(c,"-v, --version",e.greenBright(u.version)).helpOption("-h, --help",e.greenBright(u.help)).description(u.desc),o.command("build").alias("b").description(e.blueBright(l.build)).action(()=>m("build")),o.command("init").alias("i").description(e.blueBright(l.init)).action(()=>m("init")),o.command("locale").alias("l").description(e.blueBright(l.locale)).action(()=>m("locale")),o.command("new").alias("n").description(e.blueBright(l.new)).action(()=>m("new")),o.command("remove").alias("r").description(e.blueBright(l.remove)).action(()=>m("remove")),o.parse(process.argv)})();