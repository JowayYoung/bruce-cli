var x=this&&this.__awaiter||function(t,e,s,r){return new(s||(s=Promise))((function(i,n){function o(t){try{u(r.next(t))}catch(t){n(t)}}function l(t){try{u(r.throw(t))}catch(t){n(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,l)}u((r=r.apply(t,e||[])).next())}))};import{readFileSync as tt,unlinkSync as et,writeFileSync as st}from"fs";import{extname as rt}from"path";import{pathToFileURL as it}from"url";import{IsEmptyArray as nt,IsEmptyObject as z,ReadJson as a,ReadYaml as ot,NodeType as lt,AbsPath as S}from"@yangzw/bruce-us/dist/node.js";import ut from"typescript";import{BROWSERS_ES6 as ie,JudgeFile as V}from"../utils/index.js";const{ModuleKind:ct,ScriptTarget:ft,transpileModule:at}=ut;export default function W(){var t,e;return x(this,void 0,void 0,(function*(){const s="windows"===lt().system,r=V("","configFile"),i=s?it(r).href:r,n=rt(i).replace(/^\./,"");let o={};if("js"===n)o=(yield import(i)).default||{};else if("json"===n)o=null!==(t=a("brucerc.json"))&&void 0!==t?t:{};else if("ts"===n){const t=S("brucerc.ts"),e=tt(t,"utf8"),r=S("brucerc.bu.js"),i=s?it(r).href:r,n=at(e,{compilerOptions:{module:ct.ESNext,target:ft.ESNext}}).outputText;st(r,n,"utf8"),o=(yield import(i)).default||{},et(r)}else"yaml"===n&&(o=null!==(e=ot("brucerc.yaml"))&&void 0!==e?e:{});if(!z(o))for(const t in o){const e=t,s=o[e];(!s||nt(s)||z(s))&&delete o[e]}return Object.assign({alias:{},browsers:ie,buildError:null,buildSuccess:null,copyFiles:[],eslintIgnores:[],eslintRules:{},frame:"js",linkAssets:[],openPages:[],proxy:{},proxyHost:"",publicPath:"",scriptAssets:[],style:"scss",stylelintIgnores:[],stylelintRules:{},transpileDeps:[],useTs:!1},o)}))}