var g=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{a(r.next(e))}catch(e){n(e)}}function l(e){try{a(r.throw(e))}catch(e){n(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,l)}a((r=r.apply(e,t||[])).next())}))};import{readFileSync as ae,unlinkSync as ue,writeFileSync as ce}from"fs";import{extname as pe}from"path";import{pathToFileURL as fe}from"url";import{IsEmptyArray as de,IsEmptyObject as N,ReadJson as l,ReadYaml as me,NodeType as ye,AbsPath as $}from"@yangzw/bruce-us/dist/node.js";import be from"typescript";import{BROWSERS_ES6 as ie,JudgeFile as H}from"../utils/index.js";const{ModuleKind:he,ScriptTarget:xe,transpileModule:Se}=be;export default function V(){var e,t;return g(this,void 0,void 0,(function*(){const s="windows"===ye().system,r=H("","configFile"),i=s?fe(r).href:r,n=pe(i).replace(/^\./,"");let o={};if("js"===n)o=(yield import(i)).default||{};else if("json"===n)o=null!==(e=l("brucerc.json"))&&void 0!==e?e:{};else if("ts"===n){const e=$("brucerc.ts"),t=ae(e,"utf8"),r=$("brucerc.bu.js"),i=s?fe(r).href:r,n=Se(t,{compilerOptions:{module:he.ESNext,target:xe.ESNext}}).outputText;ce(r,n,"utf8"),o=(yield import(i)).default||{},ue(r)}else"yaml"===n&&(o=null!==(t=me("brucerc.yaml"))&&void 0!==t?t:{});if(!N(o))for(const e in o){const t=e,s=o[t];(!s||de(s)||N(s))&&delete o[t]}return Object.assign({alias:{},browsers:ie,buildError:null,buildSuccess:null,copyFiles:[],eslintIgnores:[],eslintRules:{},frame:"js",linkAssets:[],openPages:[],proxy:{},proxyHost:"",publicPath:"",scriptAssets:[],style:"scss",stylelintIgnores:[],stylelintRules:{},transpileDeps:[],useTs:!1},o)}))}